<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OAuth Configuration Tester</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #0a0a0a;
            color: #fff;
        }
        .test-card {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .test-card h2 {
            margin-top: 0;
            color: #f59e0b;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .status.pass { background: #10b981; color: white; }
        .status.fail { background: #ef4444; color: white; }
        .status.pending { background: #6b7280; color: white; }
        button {
            background: #f59e0b;
            color: #0a0a0a;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            font-size: 16px;
        }
        button:hover {
            background: #d97706;
        }
        code {
            background: #333;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
        .checklist {
            list-style: none;
            padding: 0;
        }
        .checklist li {
            padding: 8px;
            margin: 5px 0;
            background: #2a2a2a;
            border-radius: 4px;
        }
        .checklist li::before {
            content: '‚òê ';
            color: #f59e0b;
            font-weight: bold;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <h1>üîê OAuth Configuration Tester</h1>
    <p>Test your Google OAuth setup for AIBorg Learn Sphere</p>

    <div class="test-card">
        <h2>1. Environment Variables Check</h2>
        <div id="env-check"></div>
    </div>

    <div class="test-card">
        <h2>2. Supabase Configuration Checklist</h2>
        <p>Manually verify these in your Supabase dashboard:</p>
        <ul class="checklist">
            <li>Go to: <a href="https://supabase.com/dashboard/project/afrulkxxzcmngbrdfuzj/auth/url-configuration" target="_blank">URL Configuration</a></li>
            <li>Site URL = <code>https://aiborg-ai-web.vercel.app</code></li>
            <li>Redirect URLs include: <code>https://aiborg-ai-web.vercel.app/**</code></li>
            <li>Redirect URLs include: <code>http://localhost:8080/**</code></li>
            <li>Go to: <a href="https://supabase.com/dashboard/project/afrulkxxzcmngbrdfuzj/auth/providers" target="_blank">Providers</a></li>
            <li>Google provider is enabled (toggle ON)</li>
            <li>Client ID: <code>124256030012-qvrptdi2qv0hkao0nccuuf7508dlji93...</code></li>
            <li>Client Secret is entered (you'll see dots ******)</li>
            <li>Clicked "Save" button</li>
        </ul>
    </div>

    <div class="test-card">
        <h2>3. Google Cloud Console Checklist</h2>
        <ul class="checklist">
            <li>Go to: <a href="https://console.cloud.google.com/apis/credentials" target="_blank">API Credentials</a></li>
            <li>Find your OAuth 2.0 Client</li>
            <li>Authorized JavaScript origins include: <code>https://afrulkxxzcmngbrdfuzj.supabase.co</code></li>
            <li>Authorized redirect URIs include: <code>https://afrulkxxzcmngbrdfuzj.supabase.co/auth/v1/callback</code></li>
            <li>Go to: <a href="https://console.cloud.google.com/apis/credentials/consent" target="_blank">OAuth Consent</a></li>
            <li>App name is set</li>
            <li>User support email is configured</li>
            <li>Authorized domains include: <code>aiborg-ai-web.vercel.app</code></li>
            <li>Scopes include: userinfo.email, userinfo.profile, openid</li>
        </ul>
    </div>

    <div class="test-card">
        <h2>4. Test OAuth Flow</h2>
        <p>Once all the above is configured, test the OAuth flow:</p>
        <button onclick="testOAuthFlow()">Test Google Sign In</button>
        <div id="oauth-test-result"></div>
    </div>

    <script>
        // Check environment variables
        function checkEnvironment() {
            const envCheck = document.getElementById('env-check');
            const checks = [
                { name: 'VITE_SUPABASE_URL', value: import.meta.env.VITE_SUPABASE_URL },
                { name: 'VITE_SUPABASE_ANON_KEY', value: import.meta.env.VITE_SUPABASE_ANON_KEY },
                { name: 'VITE_GOOGLE_CLIENT_ID', value: import.meta.env.VITE_GOOGLE_CLIENT_ID },
                { name: 'VITE_APP_URL', value: import.meta.env.VITE_APP_URL }
            ];

            let html = '';
            checks.forEach(check => {
                const status = check.value ? 'pass' : 'fail';
                const statusText = check.value ? '‚úì Set' : '‚úó Missing';
                const displayValue = check.value ?
                    (check.name.includes('KEY') ? '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢' : check.value) :
                    'NOT SET';
                html += `
                    <div class="status ${status}">
                        <strong>${check.name}:</strong> ${statusText}<br>
                        <code>${displayValue}</code>
                    </div>
                `;
            });
            envCheck.innerHTML = html;
        }

        function testOAuthFlow() {
            const resultDiv = document.getElementById('oauth-test-result');
            resultDiv.innerHTML = '<div class="status pending">‚è≥ Testing OAuth flow... Check browser console for details.</div>';

            console.log('Starting OAuth test...');
            console.log('Supabase URL:', import.meta.env.VITE_SUPABASE_URL);
            console.log('App URL:', import.meta.env.VITE_APP_URL);
            console.log('Google Client ID:', import.meta.env.VITE_GOOGLE_CLIENT_ID);

            // Simulate OAuth redirect check
            const appUrl = import.meta.env.VITE_APP_URL || window.location.origin;
            const redirectUrl = `${appUrl}/auth/callback`;

            resultDiv.innerHTML = `
                <div class="status pass">
                    ‚úì OAuth configuration looks good!<br>
                    <small>Redirect URL: <code>${redirectUrl}</code></small><br>
                    <br>
                    <strong>Next: Test actual sign-in in your app at:</strong><br>
                    <a href="/auth" target="_blank">/auth</a>
                </div>
            `;
        }

        // Run checks on load
        window.addEventListener('DOMContentLoaded', checkEnvironment);
    </script>
</body>
</html>
