#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Run lint-staged for incremental linting and formatting
npx lint-staged

# Run type checking
echo "📝 Type checking..."
npx tsc --noEmit

# Check for console.log statements (except in logger.ts and test files)
echo "🔍 Checking for console.log statements..."
if grep -r "console\.\(log\|error\|warn\|info\)" --include="*.ts" --include="*.tsx" --exclude="logger.ts" --exclude="*.test.ts" --exclude="*.test.tsx" --exclude-dir="__tests__" --exclude-dir="node_modules" --exclude-dir="dist" --exclude-dir="build" src/; then
  echo "❌ Error: console.log statements found in production code"
  echo "Please use the logger utility instead: import { logger } from '@/utils/logger'"
  exit 1
fi

echo "✅ Pre-commit checks passed!"
