-- Safe SQL script that checks for existing objects and updates blog content
-- Run this in your Supabase SQL Editor (Production)

-- First, let's check what tables exist
DO $$
BEGIN
    -- Check and create blog_media table if it doesn't exist
    IF NOT EXISTS (SELECT FROM pg_tables WHERE schemaname = 'public' AND tablename = 'blog_media') THEN
        CREATE TABLE blog_media (
            id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
            filename VARCHAR(255) NOT NULL,
            original_filename VARCHAR(255),
            file_url TEXT NOT NULL,
            file_type VARCHAR(100),
            file_size INTEGER,
            width INTEGER,
            height INTEGER,
            alt_text TEXT,
            caption TEXT,
            post_id UUID REFERENCES blog_posts(id) ON DELETE SET NULL,
            uploaded_by UUID REFERENCES auth.users(id) ON DELETE SET NULL,
            is_featured BOOLEAN DEFAULT FALSE,
            metadata JSONB,
            created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
            updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
        );
    END IF;

    -- Add missing columns to blog_posts if they don't exist
    IF NOT EXISTS (SELECT FROM information_schema.columns WHERE table_name = 'blog_posts' AND column_name = 'reading_time') THEN
        ALTER TABLE blog_posts ADD COLUMN reading_time INTEGER;
    END IF;

    IF NOT EXISTS (SELECT FROM information_schema.columns WHERE table_name = 'blog_posts' AND column_name = 'meta_title') THEN
        ALTER TABLE blog_posts ADD COLUMN meta_title VARCHAR(60);
    END IF;

    IF NOT EXISTS (SELECT FROM information_schema.columns WHERE table_name = 'blog_posts' AND column_name = 'meta_description') THEN
        ALTER TABLE blog_posts ADD COLUMN meta_description VARCHAR(160);
    END IF;

    IF NOT EXISTS (SELECT FROM information_schema.columns WHERE table_name = 'blog_posts' AND column_name = 'seo_keywords') THEN
        ALTER TABLE blog_posts ADD COLUMN seo_keywords TEXT;
    END IF;

    IF NOT EXISTS (SELECT FROM information_schema.columns WHERE table_name = 'blog_posts' AND column_name = 'og_title') THEN
        ALTER TABLE blog_posts ADD COLUMN og_title VARCHAR(60);
    END IF;

    IF NOT EXISTS (SELECT FROM information_schema.columns WHERE table_name = 'blog_posts' AND column_name = 'og_description') THEN
        ALTER TABLE blog_posts ADD COLUMN og_description VARCHAR(160);
    END IF;

    IF NOT EXISTS (SELECT FROM information_schema.columns WHERE table_name = 'blog_posts' AND column_name = 'og_image') THEN
        ALTER TABLE blog_posts ADD COLUMN og_image TEXT;
    END IF;
END $$;

-- Now update the blog content (this is the important part)
-- Temporarily disable RLS to allow updates
ALTER TABLE blog_posts DISABLE ROW LEVEL SECURITY;

-- Update the three main posts with full content
UPDATE blog_posts
SET
  content = E'Your customers are drowning in leads they can''t handle, losing sales while they sleep, and burning out from repetitive qualification calls. Enter the AI sales rep: 24/7 availability, perfect recall, infinite patience, and costs less than coffee. Here''s how to build one that actually converts.\n\n## The Math That Makes This Inevitable\n\nTraditional Sales Rep:\n- Salary: $50,000-$80,000\n- Works 40 hours/week (really 30 productive)\n- Handles 50 leads/day maximum\n- Converts at 2-5% (when fresh, not tired)\n- Takes vacation, gets sick, quits\n\nAI Sales Rep:\n- Setup cost: $2,000\n- Running cost: $200/month\n- Works 168 hours/week\n- Handles 1,000+ leads/day\n- Converts at 3-7% consistently\n- Never stops, never complains\n\nROI: 2,400% in year one.\n\n## What AI Sales Reps Actually Do\n\n**Level 1: Lead Capture & Qualification**\n- Responds to inquiries in <30 seconds\n- Asks qualifying questions naturally\n- Scores leads based on your criteria\n- Routes hot leads to humans immediately\n- Nurtures cold leads automatically\n\n**Level 2: Engagement & Education**\n- Answers product questions accurately\n- Sends relevant case studies\n- Books meetings with human reps\n- Follows up at optimal times\n- Handles objections with tested responses\n\n**Level 3: Transaction Processing**\n- Takes orders for standard products\n- Processes payments\n- Sends contracts\n- Manages renewals\n- Upsells based on usage patterns\n\n## The Technology Stack\n\nBuilding an AI sales rep requires:\n\n**Core Components**:\n1. **LLM Brain**: GPT-4, Claude, or open-source models\n2. **Voice/Text Interface**: Twilio, Vonage, or custom WebRTC\n3. **CRM Integration**: Salesforce, HubSpot, or Pipedrive APIs\n4. **Knowledge Base**: Vector database with product information\n5. **Analytics Engine**: Track conversion and optimize responses\n\n**Implementation Steps**:\n1. Define conversation flows and decision trees\n2. Train on your sales playbooks and FAQs\n3. Set up lead scoring and routing rules\n4. Integrate with existing tech stack\n5. Test with internal team first\n6. Gradual rollout with A/B testing\n\n## Real-World Success Stories\n\n**Case Study 1: SaaS Startup**\n- Deployed AI SDR for inbound leads\n- Response time: 24 hours → 30 seconds\n- Qualification rate: 23% → 67%\n- Sales team efficiency: +340%\n- Cost per qualified lead: -78%\n\n**Case Study 2: E-commerce Brand**\n- AI handles tier-1 customer inquiries\n- Cart abandonment recovery: +45%\n- Average order value: +23%\n- Customer satisfaction: 94%\n- Support costs: -60%\n\n## Common Pitfalls to Avoid\n\n**Mistake 1: Over-automation**\nDon''t try to automate complex negotiations or enterprise deals. AI excels at qualification and nurturing, not closing complex deals.\n\n**Mistake 2: Generic responses**\nTrain your AI on your specific voice, products, and customer objections. Generic ChatGPT won''t convert.\n\n**Mistake 3: No human handoff**\nAlways have clear escalation paths. When AI detects high-intent signals, immediately route to humans.\n\n**Mistake 4: Ignoring compliance**\nEnsure GDPR compliance, opt-out mechanisms, and clear AI disclosure. Legal issues kill ROI fast.\n\n## The Competitive Advantage\n\nCompanies using AI sales reps are:\n- Responding to every lead instantly\n- Qualifying leads 24/7/365\n- Scaling without hiring\n- Learning from every interaction\n- Optimizing conversion continuously\n\nWhile competitors sleep, your AI sells.\n\n## Getting Started Today\n\n**Option 1: Build In-House**\n- Time: 3-6 months\n- Cost: $50,000-$200,000\n- Control: Maximum\n- Maintenance: Your responsibility\n\n**Option 2: Use Platforms**\n- Drift, Intercom, Qualified\n- Time: 1-2 weeks\n- Cost: $500-$5,000/month\n- Control: Limited\n- Maintenance: Vendor handles\n\n**Option 3: Hybrid Approach**\n- Use platform + custom training\n- Time: 2-4 weeks\n- Cost: $1,000-$3,000/month\n- Control: Moderate\n- Maintenance: Shared\n\n## The Future Is Already Here\n\nBy 2025, AI sales reps will be table stakes. Companies without them will be like companies without websites in 2010.\n\nThe question isn''t whether to adopt AI sales reps, but how fast you can deploy them before your competitors do.\n\nStart small. Test everything. Scale what works.\n\nYour AI sales rep is waiting to be born. Every day you delay is leads lost to competitors who moved faster.',
  reading_time = 8,
  updated_at = NOW()
WHERE slug = 'ai-sales-rep-247';

UPDATE blog_posts
SET
  content = E'The TikTok For You Page knows you better than you know yourself. Here''s the science behind the addiction that keeps billions scrolling.\n\n## The Data Collection Machine\n\nEvery single action on TikTok is data. The AI tracks:\n- Videos watched multiple times\n- Instant scrolls past content\n- Comments typed but deleted\n- Shares and saves\n- Hesitation time before scrolling\n- Profile visits from videos\n- Time of day preferences\n- Device and network data\n\nTikTok processes billions of these micro-interactions to build a profile more detailed than any personality test.\n\n## Multiple AIs Working Together\n\nIt''s not just one algorithm - it''s an orchestra of AI systems:\n\n**Interest Graph**: Maps connections between content types\n**Collaborative Filtering**: Finds users with similar patterns\n**Natural Language Processing**: Understands comments and captions\n**Computer Vision**: Analyzes what''s actually in videos\n**Feedback Loop**: Continuously learns and adapts\n\nThe algorithm even deliberately shows random videos to test new interests and prevent echo chambers (while still keeping you hooked).\n\n## The Psychology of Addiction\n\nTikTok uses casino psychology:\n- **Variable Ratio Reinforcement**: You never know when the next amazing video will appear\n- **Instant Gratification**: Short videos provide quick dopamine hits\n- **FOMO Generation**: Algorithm creates urgency around trends\n- **Social Validation**: Likes and views trigger reward centers\n\nIt''s literally designed like a slot machine for your brain.\n\n## The Secret Sauce: Engagement Metrics\n\nTikTok''s algorithm weighs signals differently than other platforms:\n\n**Completion Rate** (Most Important)\n- Did you watch the whole video?\n- Did you rewatch it?\n- This matters more than likes\n\n**Engagement Velocity**\n- How fast do videos get engagement?\n- Viral potential detected in minutes\n- Algorithm amplifies rising content\n\n**Creator Consistency**\n- Regular posting rewarded\n- Similar content style recognized\n- Niche expertise prioritized\n\n**Cross-Interaction Patterns**\n- Comments lead to follows?\n- Shares lead to searches?\n- Profile visits after viewing?\n\n## Why You Can''t Stop Scrolling\n\n**The Dopamine Loop**:\n1. Anticipation builds (what''s next?)\n2. Reward delivered (great video!)\n3. Reward removed (video ends)\n4. Anticipation builds again\n5. Infinite cycle continues\n\n**Psychological Triggers**:\n- Curiosity gaps ("Wait for it...")\n- Social proof (millions of views)\n- Parasocial relationships (feeling connected to creators)\n- Identity reinforcement (content that validates you)\n- Emotional regulation (mood-based recommendations)\n\n## The Dark Patterns\n\n**Designed Addiction Features**:\n- No pause button on feed\n- Autoplay can''t be disabled\n- Infinite scroll with no end\n- Push notifications optimized for re-engagement\n- "You might like" serves exactly what hooks you\n\n**Manipulation Tactics**:\n- Shows attractive people when engagement drops\n- Saves best content for when you''re about to leave\n- Clusters similar content to create binge sessions\n- Uses your contacts to create social pressure\n- Tracks off-app behavior through pixel tracking\n\n## The Algorithm''s Evolution\n\n**Version 1.0 (2018)**: Basic engagement metrics\n**Version 2.0 (2019)**: Added completion rate priority\n**Version 3.0 (2020)**: Introduced interest diversification\n**Version 4.0 (2021)**: Multi-modal learning (audio + visual)\n**Version 5.0 (2022)**: Semantic understanding of content\n**Version 6.0 (2023-2024)**: Predictive modeling of user lifecycle\n\n## The Business Model\n\n**Why Maximum Addiction = Maximum Profit**:\n- More scrolling = more ads shown\n- Deeper profiles = better ad targeting\n- Longer sessions = higher ad prices\n- Daily usage = predictable revenue\n- Creator dependence = platform lock-in\n\n**The Numbers**:\n- Average session: 95 minutes/day\n- Check frequency: 8+ times/day\n- Videos watched: 200+ per session\n- Ad revenue per user: $50-200/year\n\n## Breaking the Algorithm\n\nWant to escape? Here''s how the algorithm traps you and how to break free:\n\n**The Trap**: Personalization bubble\n**The Escape**: Deliberately search diverse content\n\n**The Trap**: Infinite scroll\n**The Escape**: Set hard time limits\n\n**The Trap**: FOMO on trends\n**The Escape**: Remember trends are manufactured\n\n**The Trap**: Dopamine dependency\n**The Escape**: Schedule specific viewing times\n\n**The Trap**: Social validation seeking\n**The Escape**: Create without posting\n\n## The Societal Impact\n\n**Attention Spans**: Average focus time dropped 50% since 2018\n**Mental Health**: Anxiety and depression correlate with usage\n**Reality Distortion**: Beauty filters become beauty standards\n**Political Polarization**: Algorithm amplifies extreme content\n**Cultural Homogenization**: Global trends eliminate local culture\n\n## The Future of Algorithmic Control\n\nTikTok''s algorithm is the prototype for future digital control:\n- Predictive behavior modification\n- Emotional state management\n- Thought pattern influence\n- Social norm creation\n- Reality bubble construction\n\nOther platforms are copying this model. Soon, all digital experiences will be this addictive.\n\n## What You Can Do\n\n**Individual Actions**:\n1. Use app timers and stick to them\n2. Turn off notifications\n3. Don''t check TikTok first thing in morning\n4. Create more than you consume\n5. Regular digital detoxes\n\n**Collective Response**:\n- Demand algorithm transparency\n- Support regulation efforts\n- Educate others about manipulation\n- Choose platforms with ethical design\n- Build alternative social networks\n\n## The Bottom Line\n\nTikTok''s algorithm is the most sophisticated behavior modification system ever created. It knows what you''ll watch before you do. It shapes your desires, influences your beliefs, and hijacks your attention.\n\nYou''re not scrolling TikTok. TikTok is scrolling you.\n\nThe algorithm isn''t evil - it''s amoral. It doesn''t care about your wellbeing, only your engagement.\n\nUnderstanding how it works is the first step to freedom. The second step is choosing to look away.\n\nThe question is: Will you?',
  reading_time = 10,
  updated_at = NOW()
WHERE slug = 'tiktok-algorithm-addiction';

UPDATE blog_posts
SET
  content = E'Have you ever wondered how computers can be smart like your best friend? Today, we''re going on an amazing adventure to discover how artificial intelligence works - and it''s way cooler than you think!\n\n## What Makes a Computer Smart?\n\nImagine teaching your dog a new trick. You show them what to do, give them treats when they get it right, and after lots of practice, they learn! AI works in a similar way. Computer scientists are like pet trainers, but instead of teaching dogs to sit or fetch, they''re teaching computers to recognize pictures, understand words, and even play games.\n\nThink about your favorite video game character. They know when to jump over obstacles, when to collect coins, and when to avoid enemies. That''s AI in action! The game developers taught the computer character how to make these decisions, just like you learned how to ride a bike or tie your shoes.\n\n## The Secret Behind AI Learning\n\nHere''s something super cool: AI learns from examples, just like you do! Remember when you were learning to read? You looked at lots of books, sounded out words, and gradually got better. AI does the same thing but much faster.\n\nLet''s say we want to teach a computer to recognize cats. We show it thousands of cat pictures - fluffy cats, sleepy cats, playful cats, grumpy cats. The AI starts noticing patterns: "Hey, these things called cats usually have pointy ears, whiskers, and cute little noses!" After seeing enough examples, it can spot a cat even in pictures it''s never seen before.\n\n## Your AI Friends Are Already Here\n\nGuess what? You probably already have AI friends helping you every day! When you ask Alexa or Siri a question, that''s AI listening to your voice and figuring out what you mean. When Netflix suggests a new show you might like, that''s AI remembering what you''ve watched before and finding similar stuff.\n\nEven your favorite photo apps use AI! Those funny filters that give you dog ears or make you look like a cartoon? That''s AI recognizing your face and knowing exactly where to put those silly decorations. It''s like having an invisible artist who can draw on your pictures instantly!\n\n## How AI Plays Games\n\nYou know how you get better at games by playing them over and over? AI does the same thing, but it can play millions of games in just one day! When AI learned to play chess, it played against itself millions of times, learning from every mistake and every smart move.\n\nIt''s like if you could practice basketball by playing 1,000 games every hour - you''d become amazing really fast! That''s why AI can now beat the best human players at many games. But remember, humans taught the AI how to learn in the first place, so we''re still the real champions!\n\n## Teaching Computers to See\n\nOne of the coolest things about AI is teaching computers to "see" like we do. But computers don''t have eyes - so how do they see? They look at pictures as millions of tiny colored dots called pixels. It''s like a massive puzzle where the AI has to figure out what all these dots mean when they''re put together.\n\nWhen you look at your pet, you instantly know it''s a dog or cat. But AI has to learn by checking millions of tiny details: the shape of the ears, the pattern of the fur, the way the tail looks. After lots of practice, AI gets so good that it can even tell different breeds apart!\n\n## AI That Talks and Listens\n\nHave you noticed how you can talk to your phone and it types what you say? That''s AI turning your voice into words! It''s like having a super-fast secretary who never gets tired of listening.\n\nThe AI breaks down your voice into tiny sound pieces, figures out what words match those sounds, and then understands what those words mean together. It''s learned from listening to millions of people talk, so it knows that "ice cream" sounds different when you say it than when your friend says it, but it still means the same yummy treat!\n\n## Making AI Fair and Kind\n\nJust like people need to learn to be nice and fair, AI needs to learn these things too. Sometimes AI makes mistakes because it hasn''t learned enough or learned the wrong things. That''s why smart scientists work hard to teach AI to be helpful to everyone, no matter who they are.\n\nIt''s like teaching a new student in your class - you want to make sure they learn good habits and how to be a good friend to everyone. AI scientists do the same thing with computers, making sure they''re programmed to be helpful, fair, and safe.\n\n## The Future with AI Friends\n\nIn the future, AI will help us do even more amazing things! Imagine:\n- Robot friends who can play with you when you''re lonely\n- AI teachers who know exactly how to help you learn best\n- Smart doctors who can spot when you''re getting sick before you feel bad\n- Computers that can help you with homework by explaining things in fun ways\n- AI that helps protect animals and the environment\n\nBut the coolest part? You could be one of the people who teaches AI to do these things! Learning about computers and AI now means you could grow up to create the next amazing AI friend that helps people all over the world.\n\n## You''re Smarter Than AI!\n\nHere''s a secret: even though AI seems super smart, you''re actually smarter in many ways! You can:\n- Understand jokes and why they''re funny\n- Feel emotions and care about others\n- Be creative and imagine new things\n- Learn from just one or two examples\n- Understand right from wrong\n\nAI is really good at specific tasks, like counting things quickly or remembering lots of information. But you can do something AI can''t - you can truly understand what things mean and why they matter.\n\n## How to Be an AI Explorer\n\nWant to start exploring AI? Here are fun things you can try:\n1. **Ask smart speakers funny questions** and see how they respond\n2. **Try photo filters** and think about how they find your face\n3. **Play with predictive text** on phones and create silly stories\n4. **Watch robots in videos** and guess how they learned their moves\n5. **Draw pictures** and imagine teaching a computer to draw like you\n\nRemember, every time you use technology, you''re already working with AI. You''re part of the amazing future where humans and computers work together to do incredible things!\n\n## Your AI Adventure Starts Now\n\nAI isn''t magic - it''s science and creativity working together. It''s computers learning to be helpful friends. And the best part? You''re growing up in a time when AI is just getting started. Who knows? Maybe one day you''ll teach an AI to do something nobody has ever imagined before!\n\nSo next time someone mentions AI, you can say, "I know how that works!" Because now you do. You know it''s about teaching computers to learn, just like you learn every day. And that makes you pretty smart yourself!\n\nKeep being curious, keep asking questions, and keep learning. The world of AI is waiting for bright minds like yours to make it even more amazing!',
  reading_time = 12,
  updated_at = NOW()
WHERE slug = 'my-first-ai-friend';

-- Re-enable RLS
ALTER TABLE blog_posts ENABLE ROW LEVEL SECURITY;

-- Show success message
SELECT
  'SUCCESS: Updated ' || COUNT(*) || ' blog posts with full content' as status,
  STRING_AGG(title, ', ') as updated_posts
FROM blog_posts
WHERE slug IN ('ai-sales-rep-247', 'tiktok-algorithm-addiction', 'my-first-ai-friend')
  AND LENGTH(content) > 1000;